(()=>{"use strict";const t=class{constructor(t){this.name=t,this.ships=[],this.board=new class{constructor(){this.boardPositionArray=[],this.hasShipArray=[],this.boardCreate()}boardCreate(){for(let t=0;t<100;t++)this.boardPositionArray.push(t)}receiveAttack(t){return this.boardPositionArray.includes(t)?(this.boardPositionArray.includes(t)&&this.boardPositionArray.splice(t,1),this.checkingIfHit(t)):"out of the box"}checkingIfHit(t){return!!this.hasShipArray.includes(t)&&(this.hasShipArray.splice(this.hasShipArray.indexOf(t),1),!0)}gameEnd(){return!(0!==this.hasShipArray.length)}shipsPlacement(t){const r=t.sort(((t,r)=>t-r)),s=[9,19,29,39,49,59,69,79,89,99],e=[90,91,92,93,94,95,96,97,98,99];for(let i=0;i<r.length-1;i++){if(t[i]<0)return!1;if(!this.boardPositionArray.includes(r[i]))return!1;if(this.hasShipArray.includes(t[i]))return!1;if(this.hasShipArray.includes(t[r.length-1]))return!1;if(r[i+1]-r[i]!=1&&r[i+1]-r[i]!=10)return!1;if(s.includes(r[i])||e.includes(r[i])){if(t.every((t=>s.includes(t)||e.includes(t))))break;if(i!==r.length||0!==i)return!1}}return this.hasShipArray.push(...r),!0}}}};class r{constructor(t,r,s,e=0){this.name=t,this.length=r,this.position=s,this.hits=e,this.hasSunken=!1}hit(t){this.position.splice(this.position.indexOf(t),1),this.hits++,this.isSunk(this.hits)}isSunk(){0===this.position.length&&(this.hasSunken=!0)}}const s=new t("player"),e=new t("computer");!function(){!function(){function t(t,r=10,s=10){t.style.setProperty("--grid-rows",r),t.style.setProperty("--grid-cols",s);for(let e=0;e<r*s;e++){const r=document.createElement("div");t.appendChild(r),r.classList.add("grid-item"),r.id=e}}const r=document.querySelector(".player-1"),s=document.querySelector(".player-2");t(r),t(s)}();const t=(r,s)=>{const e=Math.floor(100*Math.random()),i=[];for(let t=0;t<r;t++)i.push(e+t);return s.board.shipsPlacement(i)?i:t(r,s)};(()=>{let e=5;for(let i=0;i<5;i++){const o=new r(`ship${i}`,e,t(e,s));s.ships.push(o),2!==e&&e--}for(let t=0;t<5;t++)0===t&&(s.board.hasShipArray=[]),s.board.shipsPlacement(s.ships[t].position);document.querySelectorAll(".player-1 .grid-item").forEach((t=>{s.board.hasShipArray.includes(parseInt(t.id,10))&&(t.style.backgroundColor="green")}))})(),(()=>{let s=5;for(let i=0;i<5;i++){const o=new r(`ship${i}`,s,t(s,e));e.ships.push(o),2!==s&&s--}for(let t=0;t<5;t++)0===t&&(e.board.hasShipArray=[]),e.board.shipsPlacement(e.ships[t].position)})()}(),function(){const t=t=>0===t.board.hasShipArray.length&&(document.querySelector(".game").style.pointerEvents="none",console.log(`${t.name} Lost`),!0),r=[],i=document.querySelector(".player-1"),o=document.querySelector(".player-2");i.classList.add("turn");const n=[];document.querySelectorAll(".player-2 .grid-item").forEach((a=>{a.addEventListener("click",(()=>{const h=parseFloat(a.id);if(!r.includes(h)){r.push(h);const l=e.board.hasShipArray;if(l.includes(h)){if(a.style.backgroundColor="red",l.splice(l.indexOf(h),1),t(e))return 0}else a.style.backgroundColor="yellow";o.classList.add("turn"),i.classList.remove("turn"),setTimeout((()=>{(()=>{const r=Math.floor(Math.random()*e.board.boardPositionArray.length),a=e.board.boardPositionArray[r];if(e.board.boardPositionArray.splice(r,1),!n.includes(a)){const r=document.getElementById(`${a}`);n.push(a);const e=s.board.hasShipArray;if(e.includes(a)){if(r.style.backgroundColor="red",e.splice(e.indexOf(a),1),t(s))return 0}else r.style.backgroundColor="yellow";i.classList.add("turn"),o.classList.remove("turn")}})()}),1e3)}return 0}))}))}()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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aUMsT0FBTyxRQUMzQkMsWUFBVyxLQXZDRixNQUNqQixNQUFNekIsRUFBZUMsS0FBS0MsTUFBTUQsS0FBS0UsU0FBU3hCLEVBQVM5QixNQUFNQyxtQkFBbUJZLFFBQzFFTixFQUFNdUIsRUFBUzlCLE1BQU1DLG1CQUFtQmtELEdBRTFDLEdBREpyQixFQUFTOUIsTUFBTUMsbUJBQW1CUSxPQUFPMEMsRUFBYSxJQUM3Q21CLEVBQWU5RCxTQUFTRCxHQUFNLENBQy9CLE1BQU1nRSxFQUFPaEMsU0FBU3NDLGVBQWUsR0FBR3RFLEtBQ3hDK0QsRUFBZWpFLEtBQUtFLEdBQ3BCLE1BQU1tRSxFQUFZLHFCQUNsQixHQUFHQSxFQUFVbEUsU0FBU0QsSUFHbEIsR0FGQWdFLEVBQUtwQyxNQUFNMEIsZ0JBQWtCLE1BQzdCYSxFQUFVakUsT0FBT2lFLEVBQVUvRCxRQUFRSixHQUFLLEdBQ3JDMEQsRUFBYSxHQUFTLE9BQU8sT0FHaENNLEVBQUtwQyxNQUFNMEIsZ0JBQWtCLFNBRWpDaEIsRUFBVUgsVUFBVUMsSUFBSSxRQUN4QkksRUFBVUwsVUFBVWlDLE9BQU8sT0FDL0IsQ0FDUSxFQXFCQUcsRUFBYyxHQUNmLElBQ1AsQ0FDQSxPQUFPLENBQUMsR0FDWCxHQUVULENEL0RBQyxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9tb2R1bGVzL2dhbWVCb2FyZC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL21vZHVsZXMvcGxheWVyLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvbW9kdWxlcy9zaGlwLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZ2FtZUNyZWF0aW9uL3NoaXBQbGFjZW1lbnQuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9nYW1lQ3JlYXRpb24vZ2FtZUJvYXJkLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9nYW1lQ3JlYXRpb24vaGl0R2FtZUJvYXJkLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIEdhbWVCb2FyZHtcclxuICAgIGNvbnN0cnVjdG9yKCl7XHJcbiAgICAgICAgdGhpcy5ib2FyZFBvc2l0aW9uQXJyYXkgPSBbXTtcclxuICAgICAgICB0aGlzLmhhc1NoaXBBcnJheSA9IFtdO1xyXG4gICAgICAgIHRoaXMuYm9hcmRDcmVhdGUoKTsvLyBpbnN0YW50bHkgY3JlYXRlcyBhIGJvYXJkXHJcbiAgICB9XHJcblxyXG4gICAgYm9hcmRDcmVhdGUoKXtcclxuICAgICAgICBmb3IobGV0IGkgPSAwO2k8MTAwO2krKyl7XHJcbiAgICAgICAgICAgIHRoaXMuYm9hcmRQb3NpdGlvbkFycmF5LnB1c2goaSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlY2VpdmVBdHRhY2socG9zKXsvLyByZWNlaXZlcyBhdHRhY2sgYW5kIG1hcmtzIGlmIGhpdCBvciBtaXNzXHJcbiAgICAgICAgaWYoIXRoaXMuYm9hcmRQb3NpdGlvbkFycmF5LmluY2x1ZGVzKHBvcykpIHJldHVybiBcIm91dCBvZiB0aGUgYm94XCI7XHJcbiAgICAgICAgaWYodGhpcy5ib2FyZFBvc2l0aW9uQXJyYXkuaW5jbHVkZXMocG9zKSl7XHJcbiAgICAgICAgICAgIHRoaXMuYm9hcmRQb3NpdGlvbkFycmF5LnNwbGljZShwb3MsMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmNoZWNraW5nSWZIaXQocG9zKTtcclxuICAgIH1cclxuXHJcbiAgICBjaGVja2luZ0lmSGl0KHBvcyl7XHJcbiAgICAgICAgaWYodGhpcy5oYXNTaGlwQXJyYXkuaW5jbHVkZXMocG9zKSl7Ly8gY2hlY2tpbmcgaGl0LCBpZiBoaXQgcmVtb3ZlcyBibG9jayBmcm9tIHNoaXBBcnJheVxyXG4gICAgICAgICAgICB0aGlzLmhhc1NoaXBBcnJheS5zcGxpY2UodGhpcy5oYXNTaGlwQXJyYXkuaW5kZXhPZihwb3MpLDEpO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGdhbWVFbmQoKXsvLyBjaGVjayBpZiBhbGwgc2hpcHMgc3Vua1xyXG4gICAgICAgIHJldHVybiAhISh0aGlzLmhhc1NoaXBBcnJheS5sZW5ndGggPT09IDApO1xyXG4gICAgfVxyXG5cclxuICAgIHNoaXBzUGxhY2VtZW50KHNoaXBzQXJyKXtcclxuICAgICAgICBjb25zdCBzaG9ydGVkU2hpcHNBcnIgPSBzaGlwc0Fyci5zb3J0KChhLCBiKSA9PmEgLSBiKTsvLyBzb3J0aW5nXHJcbiAgICAgICAgLy8gYm9yZGVyIG9mIHRoZSBib2FyZFxyXG4gICAgICAgIGNvbnN0IGJvcmRlckhvcml6b250YWwgPSBbOSwxOSwyOSwzOSw0OSw1OSw2OSw3OSw4OSw5OV07XHJcbiAgICAgICAgY29uc3QgYm9yZGVyVmVydGljYWwgPSBbOTAsOTEsOTIsOTMsOTQsOTUsOTYsOTcsOTgsOTldO1xyXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBzaG9ydGVkU2hpcHNBcnIubGVuZ3RoLTE7aSsrKXtcclxuICAgICAgICAgICAgLy8gcGxhY2VtZW50IGJleW9uZCBib2FyZFxyXG4gICAgICAgICAgICBpZihzaGlwc0FycltpXTwwKSByZXR1cm4gZmFsc2U7XHJcbiAgICBcclxuICAgICAgICAgICAgaWYoIXRoaXMuYm9hcmRQb3NpdGlvbkFycmF5LmluY2x1ZGVzKHNob3J0ZWRTaGlwc0FycltpXSkpIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgLy8gbm8gb3ZlcmxhcHBpbmcgb2Ygc2hpcHNcclxuICAgICAgICAgICAgaWYodGhpcy5oYXNTaGlwQXJyYXkuaW5jbHVkZXMoc2hpcHNBcnJbaV0pKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIGlmKHRoaXMuaGFzU2hpcEFycmF5LmluY2x1ZGVzKHNoaXBzQXJyW3Nob3J0ZWRTaGlwc0Fyci5sZW5ndGgtMV0pKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vIHBsYWNlbWVudCBpbiByYW5kb20gb3JkZXJcclxuICAgICAgICAgICAgaWYoISgoc2hvcnRlZFNoaXBzQXJyW2krMV0gLSBzaG9ydGVkU2hpcHNBcnJbaV0pID09PSAxIFxyXG4gICAgICAgICAgICB8fCAoc2hvcnRlZFNoaXBzQXJyW2krMV0gLSBzaG9ydGVkU2hpcHNBcnJbaV0pID09PSAxMCkpIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgLy8gcGxhY2VtZW50IGNyb3NzZXMgdGhlIHZlcnRpY2FsIGFuZCBob3Jpem9udG9sIGJvcmRlclxyXG4gICAgICAgICAgICBpZihib3JkZXJIb3Jpem9udGFsLmluY2x1ZGVzKHNob3J0ZWRTaGlwc0FycltpXSkgXHJcbiAgICAgICAgICAgIHx8IGJvcmRlclZlcnRpY2FsLmluY2x1ZGVzKHNob3J0ZWRTaGlwc0FycltpXSkpe1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBpZihzaGlwc0Fyci5ldmVyeShlbGVtID0+IGJvcmRlckhvcml6b250YWwuaW5jbHVkZXMoZWxlbSkgXHJcbiAgICAgICAgICAgICAgICB8fCBib3JkZXJWZXJ0aWNhbC5pbmNsdWRlcyhlbGVtKSkpIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgaWYoIShpID09PSBzaG9ydGVkU2hpcHNBcnIubGVuZ3RoICYmIGkgPT09IDApKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gYWRkcyBzaGlwIHRvIGZyZXNoIGxvY2F0aW9uXHJcbiAgICAgICAgdGhpcy5oYXNTaGlwQXJyYXkucHVzaCguLi5zaG9ydGVkU2hpcHNBcnIpO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBHYW1lQm9hcmQiLCJpbXBvcnQgR2FtZUJvYXJkIGZyb20gXCIuL2dhbWVCb2FyZFwiO1xyXG5cclxuY2xhc3MgUGxheWVye1xyXG4gICAgY29uc3RydWN0b3IobmFtZSl7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgICAgICB0aGlzLnNoaXBzID0gW107XHJcbiAgICAgICAgdGhpcy5ib2FyZCA9IG5ldyBHYW1lQm9hcmQ7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFBsYXllciIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNoaXBze1xyXG4gICAgY29uc3RydWN0b3IobmFtZSxsZW5ndGgscG9zaXRpb24sIGhpdHMgPSAwKXtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMubGVuZ3RoID0gbGVuZ3RoO1xyXG4gICAgICAgIHRoaXMucG9zaXRpb24gPSBwb3NpdGlvbjtcclxuICAgICAgICB0aGlzLmhpdHMgPSBoaXRzO1xyXG4gICAgICAgIHRoaXMuaGFzU3Vua2VuID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgaGl0KHBvc2l0aW9uKXsvLyBoaXRzIHRoZSBwb3NpdGlvbiBhbmQgcmVtb3ZlcyB0aGUgcG9zaXRpb24gZnJvbSB0aGUgYXJyYXlcclxuICAgICAgICB0aGlzLnBvc2l0aW9uLnNwbGljZSh0aGlzLnBvc2l0aW9uLmluZGV4T2YocG9zaXRpb24pLDEpO1xyXG4gICAgICAgIHRoaXMuaGl0cysrO1xyXG4gICAgICAgIHRoaXMuaXNTdW5rKHRoaXMuaGl0cyk7XHJcbiAgICB9XHJcblxyXG4gICAgaXNTdW5rKCl7Ly8gb25jZSBhbGwgaGl0IGl0IHNpbmtzXHJcbiAgICAgICAgaWYodGhpcy5wb3NpdGlvbi5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5oYXNTdW5rZW4gPSB0cnVlO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbn0iLCIvKiBlc2xpbnQtZGlzYWJsZSBuby1jb250aW51ZSAqL1xyXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1wYXJhbS1yZWFzc2lnbiAqL1xyXG5pbXBvcnQgUGxheWVyIGZyb20gXCIuLi9tb2R1bGVzL3BsYXllclwiXHJcbmltcG9ydCBTaGlwcyBmcm9tIFwiLi4vbW9kdWxlcy9zaGlwXCJcclxuaW1wb3J0IGdhbWVCb2FyZCBmcm9tIFwiLi9nYW1lQm9hcmRcIjtcclxuXHJcbmNvbnN0IHBsYXllciA9IG5ldyBQbGF5ZXIoXCJwbGF5ZXJcIik7XHJcbmNvbnN0IGNvbXB1dGVyID0gbmV3IFBsYXllcihcImNvbXB1dGVyXCIpXHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHNoaXBzKCl7XHJcbiAgICBnYW1lQm9hcmQoKTtcclxuXHJcbiAgICBjb25zdCBnZXRSYW5kb21MZWdhbFBvc2l0aW9uID0gKGosIHBlcnNvbik9PntcclxuICAgICAgICBjb25zdCByYW5kb21OdW1iZXIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApO1xyXG4gICAgICAgIGNvbnN0IG5ld0FycmF5ID0gW107XHJcbiAgICAgICAgZm9yKGxldCBpID0gMDtpIDwgajtpKyspe1xyXG4gICAgICAgICAgICBuZXdBcnJheS5wdXNoKHJhbmRvbU51bWJlcitpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYocGVyc29uLmJvYXJkLnNoaXBzUGxhY2VtZW50KG5ld0FycmF5KSkgcmV0dXJuIG5ld0FycmF5O1xyXG4gICAgICAgIHJldHVybiBnZXRSYW5kb21MZWdhbFBvc2l0aW9uKGosIHBlcnNvbik7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcGxheWVyU2hpcHMgPSAoKT0+e1xyXG4gICAgICAgIGxldCBqID0gNTtcclxuICAgICAgICBmb3IobGV0IGkgPSAwO2kgPCA1O2krKyl7XHJcbiAgICAgICAgICAgIGNvbnN0IHBsYXllclNoaXAgPSBuZXcgU2hpcHMoYHNoaXAke2l9YCxqLCBnZXRSYW5kb21MZWdhbFBvc2l0aW9uKGosIHBsYXllcikpXHJcbiAgICAgICAgICAgIHBsYXllci5zaGlwcy5wdXNoKHBsYXllclNoaXApXHJcbiAgICAgICAgICAgIGlmKGogPT09IDIpIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICBqLS07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IobGV0IGkgPTAgOyBpPDU7aSsrKXtcclxuICAgICAgICAgICAgaWYoaT09PTApIHBsYXllci5ib2FyZC5oYXNTaGlwQXJyYXkgPSBbXTtcclxuICAgICAgICAgICAgcGxheWVyLmJvYXJkLnNoaXBzUGxhY2VtZW50KHBsYXllci5zaGlwc1tpXS5wb3NpdGlvbik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBncmlkSXRlbVBsYXllciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucGxheWVyLTEgLmdyaWQtaXRlbVwiKTtcclxuICAgICAgICBncmlkSXRlbVBsYXllci5mb3JFYWNoKChncmlkKT0+e1xyXG4gICAgICAgIGlmKHBsYXllci5ib2FyZC5oYXNTaGlwQXJyYXkuaW5jbHVkZXMocGFyc2VJbnQoZ3JpZC5pZCwgMTApKSl7XHJcbiAgICAgICAgICAgIGdyaWQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJncmVlblwiO1xyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY29tcHV0ZXJTaGlwcyA9ICgpPT57XHJcbiAgICAgICAgbGV0IGogPSA1O1xyXG4gICAgICAgIGZvcihsZXQgaSA9IDA7aSA8IDU7aSsrKXtcclxuICAgICAgICAgICAgY29uc3QgY29tcFNoaXAgPSBuZXcgU2hpcHMoYHNoaXAke2l9YCxqLCBnZXRSYW5kb21MZWdhbFBvc2l0aW9uKGosIGNvbXB1dGVyKSlcclxuICAgICAgICAgICAgY29tcHV0ZXIuc2hpcHMucHVzaChjb21wU2hpcCk7XHJcbiAgICAgICAgICAgIGlmKGogPT09IDIpIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICBqLS07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IobGV0IGkgPTAgOyBpPDU7aSsrKXtcclxuICAgICAgICAgICAgaWYoaT09PTApIGNvbXB1dGVyLmJvYXJkLmhhc1NoaXBBcnJheSA9IFtdO1xyXG4gICAgICAgICAgICBjb21wdXRlci5ib2FyZC5zaGlwc1BsYWNlbWVudChjb21wdXRlci5zaGlwc1tpXS5wb3NpdGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHBsYXllclNoaXBzKCk7XHJcbiAgICBjb21wdXRlclNoaXBzKCk7XHJcbn1cclxuXHJcbmV4cG9ydCB7cGxheWVyLCBjb21wdXRlcn0iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnYW1lQm9hcmQoKXtcclxuICAgIGZ1bmN0aW9uIG1ha2VSb3dzKGRpdixyb3dzID0gMTAsIGNvbHM9MTApIHtcclxuICAgICAgICBkaXYuc3R5bGUuc2V0UHJvcGVydHkoXCItLWdyaWQtcm93c1wiLCByb3dzKTtcclxuICAgICAgICBkaXYuc3R5bGUuc2V0UHJvcGVydHkoXCItLWdyaWQtY29sc1wiLCBjb2xzKTtcclxuICAgICAgICBmb3IgKGxldCBjID0gMDsgYyA8IChyb3dzICogY29scyk7IGMrKykge1xyXG4gICAgICAgICAgY29uc3QgY2VsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgICBkaXYuYXBwZW5kQ2hpbGQoY2VsbCk7XHJcbiAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoXCJncmlkLWl0ZW1cIik7XHJcbiAgICAgICAgICBjZWxsLmlkID0gYztcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgY29uc3QgcGxheWVyT25lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGF5ZXItMVwiKTtcclxuICAgIGNvbnN0IHBsYXllclR3byA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxheWVyLTJcIik7XHJcbiAgICBcclxuICAgIG1ha2VSb3dzKHBsYXllck9uZSk7XHJcbiAgICBtYWtlUm93cyhwbGF5ZXJUd28pO1xyXG59IiwiaW1wb3J0IGhpdEJvYXJkIGZyb20gXCIuL2dhbWVDcmVhdGlvbi9oaXRHYW1lQm9hcmRcIjtcclxuaW1wb3J0IHNoaXBzICBmcm9tIFwiLi9nYW1lQ3JlYXRpb24vc2hpcFBsYWNlbWVudFwiO1xyXG5cclxuc2hpcHMoKVxyXG5oaXRCb2FyZCgpOyIsIi8qIGVzbGludC1kaXNhYmxlIG5vLXBhcmFtLXJlYXNzaWduICovXHJcbmltcG9ydCB7IGNvbXB1dGVyLCBwbGF5ZXIgfSBmcm9tIFwiLi9zaGlwUGxhY2VtZW50XCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBoaXRCb2FyZCgpe1xyXG5cclxuICAgIGNvbnN0IGNoZWNrR2FtZUVuZCA9IChwZXJzb24pPT57XHJcbiAgICAgICAgaWYocGVyc29uLmJvYXJkLmhhc1NoaXBBcnJheS5sZW5ndGggPT09IDApe1xyXG4gICAgICAgICAgICBjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYW1lXCIpO1xyXG4gICAgICAgICAgICBtYWluLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcIm5vbmVcIlxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgJHtwZXJzb24ubmFtZX0gTG9zdGApXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHNob3RzQXJyYXkgPSBbXTtcclxuICAgIGNvbnN0IHBsYXllck9uZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxheWVyLTFcIik7XHJcbiAgICBjb25zdCBwbGF5ZXJUd28gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYXllci0yXCIpO1xyXG4gICAgcGxheWVyT25lLmNsYXNzTGlzdC5hZGQoXCJ0dXJuXCIpXHJcbiAgICBjb25zdCBzaG90c0FycmF5Q29tcCA9IFtdXHJcblxyXG4gICAgY29uc3QgY29tcHV0ZXJQbGF5ID0gKCk9PntcclxuICAgICAgICBjb25zdCByYW5kb21OdW1iZXIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqY29tcHV0ZXIuYm9hcmQuYm9hcmRQb3NpdGlvbkFycmF5Lmxlbmd0aClcclxuICAgICAgICBjb25zdCBwb3MgPSBjb21wdXRlci5ib2FyZC5ib2FyZFBvc2l0aW9uQXJyYXlbcmFuZG9tTnVtYmVyXTtcclxuICAgICAgICBjb21wdXRlci5ib2FyZC5ib2FyZFBvc2l0aW9uQXJyYXkuc3BsaWNlKHJhbmRvbU51bWJlciwxKVxyXG4gICAgICAgICAgICBpZighKHNob3RzQXJyYXlDb21wLmluY2x1ZGVzKHBvcykpKXtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHtwb3N9YClcclxuICAgICAgICAgICAgICAgIHNob3RzQXJyYXlDb21wLnB1c2gocG9zKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNoaXBBcnJheSA9IHBsYXllci5ib2FyZC5oYXNTaGlwQXJyYXlcclxuICAgICAgICAgICAgICAgIGlmKHNoaXBBcnJheS5pbmNsdWRlcyhwb3MpKXtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwicmVkXCJcclxuICAgICAgICAgICAgICAgICAgICBzaGlwQXJyYXkuc3BsaWNlKHNoaXBBcnJheS5pbmRleE9mKHBvcyksMSlcclxuICAgICAgICAgICAgICAgICAgICBpZihjaGVja0dhbWVFbmQocGxheWVyKSkgcmV0dXJuIDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJ5ZWxsb3dcIlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcGxheWVyT25lLmNsYXNzTGlzdC5hZGQoXCJ0dXJuXCIpO1xyXG4gICAgICAgICAgICAgICAgcGxheWVyVHdvLmNsYXNzTGlzdC5yZW1vdmUoXCJ0dXJuXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGdyaWRJdGVtQ29tcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucGxheWVyLTIgLmdyaWQtaXRlbVwiKTtcclxuICAgIGdyaWRJdGVtQ29tcC5mb3JFYWNoKChpdGVtKT0+e1xyXG4gICAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpPT57XHJcbiAgICAgICAgICAgIGNvbnN0IHBvcyA9IHBhcnNlRmxvYXQoaXRlbS5pZClcclxuICAgICAgICAgICAgaWYoIShzaG90c0FycmF5LmluY2x1ZGVzKHBvcykpKXtcclxuICAgICAgICAgICAgICAgIHNob3RzQXJyYXkucHVzaChwb3MpO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2hpcEFycmF5ID0gY29tcHV0ZXIuYm9hcmQuaGFzU2hpcEFycmF5XHJcbiAgICAgICAgICAgICAgICBpZihzaGlwQXJyYXkuaW5jbHVkZXMocG9zKSl7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcInJlZFwiXHJcbiAgICAgICAgICAgICAgICAgICAgc2hpcEFycmF5LnNwbGljZShzaGlwQXJyYXkuaW5kZXhPZihwb3MpLDEpXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoY2hlY2tHYW1lRW5kKGNvbXB1dGVyKSkgcmV0dXJuIDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW0uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJ5ZWxsb3dcIlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcGxheWVyVHdvLmNsYXNzTGlzdC5hZGQoXCJ0dXJuXCIpO1xyXG4gICAgICAgICAgICAgICAgcGxheWVyT25lLmNsYXNzTGlzdC5yZW1vdmUoXCJ0dXJuXCIpO1xyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29tcHV0ZXJQbGF5KCk7XHJcbiAgICAgICAgICAgICAgICB9LCAxMDAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICB9KVxyXG4gICAgfSlcclxufSJdLCJuYW1lcyI6WyJjb25zdHJ1Y3RvciIsIm5hbWUiLCJ0aGlzIiwic2hpcHMiLCJib2FyZCIsImJvYXJkUG9zaXRpb25BcnJheSIsImhhc1NoaXBBcnJheSIsImJvYXJkQ3JlYXRlIiwiaSIsInB1c2giLCJyZWNlaXZlQXR0YWNrIiwicG9zIiwiaW5jbHVkZXMiLCJzcGxpY2UiLCJjaGVja2luZ0lmSGl0IiwiaW5kZXhPZiIsImdhbWVFbmQiLCJsZW5ndGgiLCJzaGlwc1BsYWNlbWVudCIsInNoaXBzQXJyIiwic2hvcnRlZFNoaXBzQXJyIiwic29ydCIsImEiLCJiIiwiYm9yZGVySG9yaXpvbnRhbCIsImJvcmRlclZlcnRpY2FsIiwiZXZlcnkiLCJlbGVtIiwiU2hpcHMiLCJwb3NpdGlvbiIsImhpdHMiLCJoYXNTdW5rZW4iLCJoaXQiLCJpc1N1bmsiLCJjb21wdXRlciIsIm1ha2VSb3dzIiwiZGl2Iiwicm93cyIsImNvbHMiLCJzdHlsZSIsInNldFByb3BlcnR5IiwiYyIsImNlbGwiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJhcHBlbmRDaGlsZCIsImNsYXNzTGlzdCIsImFkZCIsImlkIiwicGxheWVyT25lIiwicXVlcnlTZWxlY3RvciIsInBsYXllclR3byIsImdldFJhbmRvbUxlZ2FsUG9zaXRpb24iLCJqIiwicGVyc29uIiwicmFuZG9tTnVtYmVyIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwibmV3QXJyYXkiLCJwbGF5ZXJTaGlwIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJncmlkIiwicGFyc2VJbnQiLCJiYWNrZ3JvdW5kQ29sb3IiLCJwbGF5ZXJTaGlwcyIsImNvbXBTaGlwIiwiY29tcHV0ZXJTaGlwcyIsImNoZWNrR2FtZUVuZCIsInBvaW50ZXJFdmVudHMiLCJjb25zb2xlIiwibG9nIiwic2hvdHNBcnJheSIsInNob3RzQXJyYXlDb21wIiwiaXRlbSIsImFkZEV2ZW50TGlzdGVuZXIiLCJwYXJzZUZsb2F0Iiwic2hpcEFycmF5IiwicmVtb3ZlIiwic2V0VGltZW91dCIsImdldEVsZW1lbnRCeUlkIiwiY29tcHV0ZXJQbGF5IiwiaGl0Qm9hcmQiXSwic291cmNlUm9vdCI6IiJ9