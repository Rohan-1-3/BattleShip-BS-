(()=>{"use strict";const e=class{constructor(e){this.name=e,this.ships=[],this.board=new class{constructor(){this.boardPositionArray=[],this.hasShipArray=[],this.boardCreate()}boardCreate(){for(let e=0;e<100;e++)this.boardPositionArray.push(e)}receiveAttack(e){return this.boardPositionArray.includes(e)?(this.boardPositionArray.includes(e)&&this.boardPositionArray.splice(e,1),this.checkingIfHit(e)):"out of the box"}checkingIfHit(e){return!!this.hasShipArray.includes(e)&&(this.hasShipArray.splice(this.hasShipArray.indexOf(e),1),!0)}gameEnd(){return!(0!==this.hasShipArray.length)}shipsPlacement(e){const s=e.sort(((e,s)=>e-s)),r=[9,19,29,39,49,59,69,79,89,99],t=[90,91,92,93,94,95,96,97,98,99];for(let i=0;i<s.length-1;i++){if(e[i]<0)return!1;if(!this.boardPositionArray.includes(s[i]))return!1;if(this.hasShipArray.includes(e[i]))return!1;if(this.hasShipArray.includes(e[s.length-1]))return!1;if(s[i+1]-s[i]!=1&&s[i+1]-s[i]!=10)return!1;if(r.includes(s[i])||t.includes(s[i])){if(e.every((e=>r.includes(e)||t.includes(e))))break;if(i!==s.length||0!==i)return!1}}return this.hasShipArray.push(...s),!0}}}};class s{constructor(e,s,r,t=0){this.name=e,this.length=s,this.position=r,this.hits=t,this.hasSunken=!1}hit(e){this.position.splice(this.position.indexOf(e),1),this.hits++,this.isSunk(this.hits)}isSunk(){0===this.position.length&&(this.hasSunken=!0)}}const r=new e("player"),t=new e("computer");!function(){!function(){function e(e,s=10,r=10){e.style.setProperty("--grid-rows",s),e.style.setProperty("--grid-cols",r);for(let t=0;t<s*r;t++){const s=document.createElement("div");e.appendChild(s),s.classList.add("grid-item"),s.id=t}}const s=document.querySelector(".player-1"),r=document.querySelector(".player-2");e(s),e(r)}();const e=(s,r)=>{const t=Math.floor(100*Math.random()),i=[];for(let e=0;e<s;e++)i.push(t+e);return r.board.shipsPlacement(i)?i:e(s,r)};(()=>{let t=5;for(let i=0;i<5;i++){const o=new s(`ship${i}`,t,e(t,r));r.ships.push(o),2!==t&&t--}for(let e=0;e<5;e++)0===e&&(r.board.hasShipArray=[]),console.log(r.board.shipsPlacement(r.ships[e].position));document.querySelectorAll(".player-1 .grid-item").forEach((e=>{r.board.hasShipArray.includes(parseInt(e.id,10))&&(e.style.backgroundColor="green")}))})(),(()=>{let r=5;for(let i=0;i<5;i++){const o=new s(`ship${i}`,r,e(r,t));t.ships.push(o),console.log("ok"),2!==r&&r--}for(let e=0;e<5;e++)0===e&&(t.board.hasShipArray=[]),console.log(t.board.shipsPlacement(t.ships[e].position));document.querySelectorAll(".player-2 .grid-item").forEach((e=>{t.board.hasShipArray.includes(parseInt(e.id,10))&&(e.style.backgroundColor="green")}))})(),console.log(t)}(),function(){const e=e=>{0===e.board.hasShipArray.length&&(document.querySelector(".game").style.pointerEvents="none")},s=[];document.querySelectorAll(".player-1 .grid-item").forEach((t=>{t.addEventListener("click",(()=>{const i=parseFloat(t.id);if(!s.includes(i)){s.push(i),console.log(t.id),console.log(r.board);const o=r.board.hasShipArray;o.includes(i)?(t.style.backgroundColor="red",o.splice(o.indexOf(i),1),e(r)):t.style.backgroundColor="yellow"}}))}));const i=[];document.querySelectorAll(".player-2 .grid-item").forEach((s=>{s.addEventListener("click",(()=>{const o=parseFloat(s.id);if(!i.includes(o)){i.push(o),console.log(s.id),console.log(r.board);const n=t.board.hasShipArray;n.includes(o)?(s.style.backgroundColor="red",n.splice(n.indexOf(o),1),e(t)):s.style.backgroundColor="yellow"}}))}))}()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoibUJBZ0VBLE1DdERBLEVBUkEsTUFDSUEsWUFBWUMsR0FDUkMsS0FBS0QsS0FBT0EsRUFDWkMsS0FBS0MsTUFBUSxHQUNiRCxLQUFLRSxNQUFRLElETnJCLE1BQ0lKLGNBQ0lFLEtBQUtHLG1CQUFxQixHQUMxQkgsS0FBS0ksYUFBZSxHQUNwQkosS0FBS0ssYUFDVCxDQUVBQSxjQUNJLElBQUksSUFBSUMsRUFBSSxFQUFFQSxFQUFFLElBQUlBLElBQ2hCTixLQUFLRyxtQkFBbUJJLEtBQUtELEVBRXJDLENBRUFFLGNBQWNDLEdBQ1YsT0FBSVQsS0FBS0csbUJBQW1CTyxTQUFTRCxJQUNsQ1QsS0FBS0csbUJBQW1CTyxTQUFTRCxJQUNoQ1QsS0FBS0csbUJBQW1CUSxPQUFPRixFQUFJLEdBRWhDVCxLQUFLWSxjQUFjSCxJQUp3QixnQkFLdEQsQ0FFQUcsY0FBY0gsR0FDVixRQUFHVCxLQUFLSSxhQUFhTSxTQUFTRCxLQUMxQlQsS0FBS0ksYUFBYU8sT0FBT1gsS0FBS0ksYUFBYVMsUUFBUUosR0FBSyxJQUNqRCxFQUdmLENBRUFLLFVBQ0ksUUFBdUMsSUFBN0JkLEtBQUtJLGFBQWFXLE9BQ2hDLENBRUFDLGVBQWVDLEdBQ1gsTUFBTUMsRUFBa0JELEVBQVNFLE1BQUssQ0FBQ0MsRUFBR0MsSUFBS0QsRUFBSUMsSUFFN0NDLEVBQW1CLENBQUMsRUFBRSxHQUFHLEdBQUcsR0FBRyxHQUFHLEdBQUcsR0FBRyxHQUFHLEdBQUcsSUFDOUNDLEVBQWlCLENBQUMsR0FBRyxHQUFHLEdBQUcsR0FBRyxHQUFHLEdBQUcsR0FBRyxHQUFHLEdBQUcsSUFDbkQsSUFBSSxJQUFJakIsRUFBSSxFQUFHQSxFQUFJWSxFQUFnQkgsT0FBTyxFQUFFVCxJQUFJLENBRTVDLEdBQUdXLEVBQVNYLEdBQUcsRUFBRyxPQUFPLEVBRXpCLElBQUlOLEtBQUtHLG1CQUFtQk8sU0FBU1EsRUFBZ0JaLElBQUssT0FBTyxFQUVqRSxHQUFHTixLQUFLSSxhQUFhTSxTQUFTTyxFQUFTWCxJQUFLLE9BQU8sRUFDbkQsR0FBR04sS0FBS0ksYUFBYU0sU0FBU08sRUFBU0MsRUFBZ0JILE9BQU8sSUFBSyxPQUFPLEVBRTFFLEdBQU1HLEVBQWdCWixFQUFFLEdBQUtZLEVBQWdCWixJQUFRLEdBQ2pEWSxFQUFnQlosRUFBRSxHQUFLWSxFQUFnQlosSUFBUSxHQUFLLE9BQU8sRUFFL0QsR0FBR2dCLEVBQWlCWixTQUFTUSxFQUFnQlosS0FDMUNpQixFQUFlYixTQUFTUSxFQUFnQlosSUFBSSxDQUUzQyxHQUFHVyxFQUFTTyxPQUFNQyxHQUFRSCxFQUFpQlosU0FBU2UsSUFDakRGLEVBQWViLFNBQVNlLEtBQVEsTUFDbkMsR0FBS25CLElBQU1ZLEVBQWdCSCxRQUFnQixJQUFOVCxFQUFVLE9BQU8sQ0FDMUQsQ0FDSixDQUdBLE9BREFOLEtBQUtJLGFBQWFHLFFBQVFXLElBQ25CLENBQ1gsRUN0REEsR0NQVyxNQUFNUSxFQUNqQjVCLFlBQVlDLEVBQUtnQixFQUFPWSxFQUFVQyxFQUFPLEdBQ3JDNUIsS0FBS0QsS0FBT0EsRUFDWkMsS0FBS2UsT0FBU0EsRUFDZGYsS0FBSzJCLFNBQVdBLEVBQ2hCM0IsS0FBSzRCLEtBQU9BLEVBQ1o1QixLQUFLNkIsV0FBWSxDQUNyQixDQUVBQyxJQUFJSCxHQUNBM0IsS0FBSzJCLFNBQVNoQixPQUFPWCxLQUFLMkIsU0FBU2QsUUFBUWMsR0FBVSxHQUNyRDNCLEtBQUs0QixPQUNMNUIsS0FBSytCLE9BQU8vQixLQUFLNEIsS0FDckIsQ0FFQUcsU0FDZ0MsSUFBekIvQixLQUFLMkIsU0FBU1osU0FDYmYsS0FBSzZCLFdBQVksRUFFekIsRUNkSixNQUFNLEVBQVMsSUFBSSxFQUFPLFVBQ3BCRyxFQUFXLElBQUksRUFBTyxhQUNiLFlDUEEsV0FDWCxTQUFTQyxFQUFTQyxFQUFJQyxFQUFPLEdBQUlDLEVBQUssSUFDbENGLEVBQUlHLE1BQU1DLFlBQVksY0FBZUgsR0FDckNELEVBQUlHLE1BQU1DLFlBQVksY0FBZUYsR0FDckMsSUFBSyxJQUFJRyxFQUFJLEVBQUdBLEVBQUtKLEVBQU9DLEVBQU9HLElBQUssQ0FDdEMsTUFBTUMsRUFBT0MsU0FBU0MsY0FBYyxPQUNwQ1IsRUFBSVMsWUFBWUgsR0FDaEJBLEVBQUtJLFVBQVVDLElBQUksYUFDbkJMLEVBQUtNLEdBQUtQLENBQ1osQ0FDSixDQUVBLE1BQU1RLEVBQVlOLFNBQVNPLGNBQWMsYUFDbkNDLEVBQVlSLFNBQVNPLGNBQWMsYUFFekNmLEVBQVNjLEdBQ1RkLEVBQVNnQixFQUNiLENEVEksR0FFQSxNQUFNQyxFQUF5QixDQUFDQyxFQUFHQyxLQUMvQixNQUFNQyxFQUFlQyxLQUFLQyxNQUFzQixJQUFoQkQsS0FBS0UsVUFDL0JDLEVBQVcsR0FDakIsSUFBSSxJQUFJbkQsRUFBSSxFQUFFQSxFQUFJNkMsRUFBRTdDLElBQ2hCbUQsRUFBU2xELEtBQUs4QyxFQUFhL0MsR0FFL0IsT0FBRzhDLEVBQU9sRCxNQUFNYyxlQUFleUMsR0FBa0JBLEVBQzFDUCxFQUF1QkMsRUFBR0MsRUFBTyxFQUd4QixNQUNoQixJQUFJRCxFQUFJLEVBQ1IsSUFBSSxJQUFJN0MsRUFBSSxFQUFFQSxFQUFJLEVBQUVBLElBQUksQ0FFcEIsTUFBTW9ELEVBQWEsSUFBSWhDLEVBQU0sT0FBT3BCLElBQUk2QyxFQUFHRCxFQUF1QkMsRUFBRyxJQUNyRSxFQUFPbEQsTUFBTU0sS0FBS21ELEdBQ1QsSUFBTlAsR0FDSEEsR0FDSixDQUVBLElBQUksSUFBSTdDLEVBQUcsRUFBSUEsRUFBRSxFQUFFQSxJQUNSLElBQUpBLElBQU8sRUFBT0osTUFBTUUsYUFBZSxJQUN0Q3VELFFBQVFDLElBQUksRUFBTzFELE1BQU1jLGVBQWUsRUFBT2YsTUFBTUssR0FBR3FCLFdBR3JDYyxTQUFTb0IsaUJBQWlCLHdCQUNsQ0MsU0FBU0MsSUFDckIsRUFBTzdELE1BQU1FLGFBQWFNLFNBQVNzRCxTQUFTRCxFQUFLakIsR0FBSSxPQUNwRGlCLEVBQUsxQixNQUFNNEIsZ0JBQWtCLFFBQ2pDLEdBQ0gsRUEyQkRDLEdBeEJzQixNQUNsQixJQUFJZixFQUFJLEVBQ1IsSUFBSSxJQUFJN0MsRUFBSSxFQUFFQSxFQUFJLEVBQUVBLElBQUksQ0FFcEIsTUFBTTZELEVBQVcsSUFBSXpDLEVBQU0sT0FBT3BCLElBQUk2QyxFQUFHRCxFQUF1QkMsRUFBR25CLElBQ25FQSxFQUFTL0IsTUFBTU0sS0FBSzRELEdBQ3BCUixRQUFRQyxJQUFJLE1BQ0gsSUFBTlQsR0FDSEEsR0FDSixDQUVBLElBQUksSUFBSTdDLEVBQUcsRUFBSUEsRUFBRSxFQUFFQSxJQUNSLElBQUpBLElBQU8wQixFQUFTOUIsTUFBTUUsYUFBZSxJQUN4Q3VELFFBQVFDLElBQUk1QixFQUFTOUIsTUFBTWMsZUFBZWdCLEVBQVMvQixNQUFNSyxHQUFHcUIsV0FHM0NjLFNBQVNvQixpQkFBaUIsd0JBQ2xDQyxTQUFTQyxJQUNuQi9CLEVBQVM5QixNQUFNRSxhQUFhTSxTQUFTc0QsU0FBU0QsRUFBS2pCLEdBQUksT0FDdERpQixFQUFLMUIsTUFBTTRCLGdCQUFrQixRQUNqQyxHQUNILEVBSURHLEdBRUFULFFBQVFDLElBQUk1QixFQUNoQixDRXBFQS9CLEdDRGUsV0FFWCxNQUFNb0UsRUFBZ0JqQixJQUNzQixJQUFyQ0EsRUFBT2xELE1BQU1FLGFBQWFXLFNBQ1owQixTQUFTTyxjQUFjLFNBQy9CWCxNQUFNaUMsY0FBZ0IsT0FDOUIsRUFFQ0MsRUFBYSxHQUNGOUIsU0FBU29CLGlCQUFpQix3QkFDbENDLFNBQVNVLElBQ2RBLEVBQUtDLGlCQUFpQixTQUFTLEtBQzNCLE1BQU1oRSxFQUFNaUUsV0FBV0YsRUFBSzFCLElBQzVCLElBQUt5QixFQUFXN0QsU0FBU0QsR0FBTSxDQUMzQjhELEVBQVdoRSxLQUFLRSxHQUNoQmtELFFBQVFDLElBQUtZLEVBQU8sSUFDcEJiLFFBQVFDLElBQUksU0FDWixNQUFNZSxFQUFZLHFCQUNmQSxFQUFVakUsU0FBU0QsSUFDbEIrRCxFQUFLbkMsTUFBTTRCLGdCQUFrQixNQUM3QlUsRUFBVWhFLE9BQU9nRSxFQUFVOUQsUUFBUUosR0FBSyxHQUN4QzRELEVBQWEsSUFHYkcsRUFBS25DLE1BQU00QixnQkFBa0IsUUFFckMsSUFDSCxJQUdMLE1BQU1XLEVBQWlCLEdBQ0ZuQyxTQUFTb0IsaUJBQWlCLHdCQUNsQ0MsU0FBU1UsSUFDbEJBLEVBQUtDLGlCQUFpQixTQUFTLEtBQzNCLE1BQU1oRSxFQUFNaUUsV0FBV0YsRUFBSzFCLElBQzVCLElBQUs4QixFQUFlbEUsU0FBU0QsR0FBTSxDQUMvQm1FLEVBQWVyRSxLQUFLRSxHQUNwQmtELFFBQVFDLElBQUtZLEVBQU8sSUFDcEJiLFFBQVFDLElBQUksU0FDWixNQUFNZSxFQUFZM0MsRUFBUzlCLE1BQU1FLGFBQzlCdUUsRUFBVWpFLFNBQVNELElBQ2xCK0QsRUFBS25DLE1BQU00QixnQkFBa0IsTUFDN0JVLEVBQVVoRSxPQUFPZ0UsRUFBVTlELFFBQVFKLEdBQUssR0FDeEM0RCxFQUFhckMsSUFHYndDLEVBQUtuQyxNQUFNNEIsZ0JBQWtCLFFBRXJDLElBQ0gsR0FFVCxDRGpEQVksRSIsInNvdXJjZXMiOlsid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvbW9kdWxlcy9nYW1lQm9hcmQuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9tb2R1bGVzL3BsYXllci5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL21vZHVsZXMvc2hpcC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2dhbWVDcmVhdGlvbi9zaGlwUGxhY2VtZW50LmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZ2FtZUNyZWF0aW9uL2dhbWVCb2FyZC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2luZGV4LmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZ2FtZUNyZWF0aW9uL2hpdEdhbWVCb2FyZC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBHYW1lQm9hcmR7XHJcbiAgICBjb25zdHJ1Y3Rvcigpe1xyXG4gICAgICAgIHRoaXMuYm9hcmRQb3NpdGlvbkFycmF5ID0gW107XHJcbiAgICAgICAgdGhpcy5oYXNTaGlwQXJyYXkgPSBbXTtcclxuICAgICAgICB0aGlzLmJvYXJkQ3JlYXRlKCk7Ly8gaW5zdGFudGx5IGNyZWF0ZXMgYSBib2FyZFxyXG4gICAgfVxyXG5cclxuICAgIGJvYXJkQ3JlYXRlKCl7XHJcbiAgICAgICAgZm9yKGxldCBpID0gMDtpPDEwMDtpKyspe1xyXG4gICAgICAgICAgICB0aGlzLmJvYXJkUG9zaXRpb25BcnJheS5wdXNoKGkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZWNlaXZlQXR0YWNrKHBvcyl7Ly8gcmVjZWl2ZXMgYXR0YWNrIGFuZCBtYXJrcyBpZiBoaXQgb3IgbWlzc1xyXG4gICAgICAgIGlmKCF0aGlzLmJvYXJkUG9zaXRpb25BcnJheS5pbmNsdWRlcyhwb3MpKSByZXR1cm4gXCJvdXQgb2YgdGhlIGJveFwiO1xyXG4gICAgICAgIGlmKHRoaXMuYm9hcmRQb3NpdGlvbkFycmF5LmluY2x1ZGVzKHBvcykpe1xyXG4gICAgICAgICAgICB0aGlzLmJvYXJkUG9zaXRpb25BcnJheS5zcGxpY2UocG9zLDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5jaGVja2luZ0lmSGl0KHBvcyk7XHJcbiAgICB9XHJcblxyXG4gICAgY2hlY2tpbmdJZkhpdChwb3Mpe1xyXG4gICAgICAgIGlmKHRoaXMuaGFzU2hpcEFycmF5LmluY2x1ZGVzKHBvcykpey8vIGNoZWNraW5nIGhpdCwgaWYgaGl0IHJlbW92ZXMgYmxvY2sgZnJvbSBzaGlwQXJyYXlcclxuICAgICAgICAgICAgdGhpcy5oYXNTaGlwQXJyYXkuc3BsaWNlKHRoaXMuaGFzU2hpcEFycmF5LmluZGV4T2YocG9zKSwxKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBnYW1lRW5kKCl7Ly8gY2hlY2sgaWYgYWxsIHNoaXBzIHN1bmtcclxuICAgICAgICByZXR1cm4gISEodGhpcy5oYXNTaGlwQXJyYXkubGVuZ3RoID09PSAwKTtcclxuICAgIH1cclxuXHJcbiAgICBzaGlwc1BsYWNlbWVudChzaGlwc0Fycil7XHJcbiAgICAgICAgY29uc3Qgc2hvcnRlZFNoaXBzQXJyID0gc2hpcHNBcnIuc29ydCgoYSwgYikgPT5hIC0gYik7Ly8gc29ydGluZ1xyXG4gICAgICAgIC8vIGJvcmRlciBvZiB0aGUgYm9hcmRcclxuICAgICAgICBjb25zdCBib3JkZXJIb3Jpem9udGFsID0gWzksMTksMjksMzksNDksNTksNjksNzksODksOTldO1xyXG4gICAgICAgIGNvbnN0IGJvcmRlclZlcnRpY2FsID0gWzkwLDkxLDkyLDkzLDk0LDk1LDk2LDk3LDk4LDk5XTtcclxuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgc2hvcnRlZFNoaXBzQXJyLmxlbmd0aC0xO2krKyl7XHJcbiAgICAgICAgICAgIC8vIHBsYWNlbWVudCBiZXlvbmQgYm9hcmRcclxuICAgICAgICAgICAgaWYoc2hpcHNBcnJbaV08MCkgcmV0dXJuIGZhbHNlO1xyXG4gICAgXHJcbiAgICAgICAgICAgIGlmKCF0aGlzLmJvYXJkUG9zaXRpb25BcnJheS5pbmNsdWRlcyhzaG9ydGVkU2hpcHNBcnJbaV0pKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vIG5vIG92ZXJsYXBwaW5nIG9mIHNoaXBzXHJcbiAgICAgICAgICAgIGlmKHRoaXMuaGFzU2hpcEFycmF5LmluY2x1ZGVzKHNoaXBzQXJyW2ldKSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICBpZih0aGlzLmhhc1NoaXBBcnJheS5pbmNsdWRlcyhzaGlwc0FycltzaG9ydGVkU2hpcHNBcnIubGVuZ3RoLTFdKSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAvLyBwbGFjZW1lbnQgaW4gcmFuZG9tIG9yZGVyXHJcbiAgICAgICAgICAgIGlmKCEoKHNob3J0ZWRTaGlwc0FycltpKzFdIC0gc2hvcnRlZFNoaXBzQXJyW2ldKSA9PT0gMSBcclxuICAgICAgICAgICAgfHwgKHNob3J0ZWRTaGlwc0FycltpKzFdIC0gc2hvcnRlZFNoaXBzQXJyW2ldKSA9PT0gMTApKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vIHBsYWNlbWVudCBjcm9zc2VzIHRoZSB2ZXJ0aWNhbCBhbmQgaG9yaXpvbnRvbCBib3JkZXJcclxuICAgICAgICAgICAgaWYoYm9yZGVySG9yaXpvbnRhbC5pbmNsdWRlcyhzaG9ydGVkU2hpcHNBcnJbaV0pIFxyXG4gICAgICAgICAgICB8fCBib3JkZXJWZXJ0aWNhbC5pbmNsdWRlcyhzaG9ydGVkU2hpcHNBcnJbaV0pKXtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYoc2hpcHNBcnIuZXZlcnkoZWxlbSA9PiBib3JkZXJIb3Jpem9udGFsLmluY2x1ZGVzKGVsZW0pIFxyXG4gICAgICAgICAgICAgICAgfHwgYm9yZGVyVmVydGljYWwuaW5jbHVkZXMoZWxlbSkpKSBicmVhaztcclxuICAgICAgICAgICAgICAgIGlmKCEoaSA9PT0gc2hvcnRlZFNoaXBzQXJyLmxlbmd0aCAmJiBpID09PSAwKSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGFkZHMgc2hpcCB0byBmcmVzaCBsb2NhdGlvblxyXG4gICAgICAgIHRoaXMuaGFzU2hpcEFycmF5LnB1c2goLi4uc2hvcnRlZFNoaXBzQXJyKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgR2FtZUJvYXJkIiwiaW1wb3J0IEdhbWVCb2FyZCBmcm9tIFwiLi9nYW1lQm9hcmRcIjtcclxuXHJcbmNsYXNzIFBsYXllcntcclxuICAgIGNvbnN0cnVjdG9yKG5hbWUpe1xyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5zaGlwcyA9IFtdO1xyXG4gICAgICAgIHRoaXMuYm9hcmQgPSBuZXcgR2FtZUJvYXJkO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQbGF5ZXIiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTaGlwc3tcclxuICAgIGNvbnN0cnVjdG9yKG5hbWUsbGVuZ3RoLHBvc2l0aW9uLCBoaXRzID0gMCl7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgICAgICB0aGlzLmxlbmd0aCA9IGxlbmd0aDtcclxuICAgICAgICB0aGlzLnBvc2l0aW9uID0gcG9zaXRpb247XHJcbiAgICAgICAgdGhpcy5oaXRzID0gaGl0cztcclxuICAgICAgICB0aGlzLmhhc1N1bmtlbiA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGhpdChwb3NpdGlvbil7Ly8gaGl0cyB0aGUgcG9zaXRpb24gYW5kIHJlbW92ZXMgdGhlIHBvc2l0aW9uIGZyb20gdGhlIGFycmF5XHJcbiAgICAgICAgdGhpcy5wb3NpdGlvbi5zcGxpY2UodGhpcy5wb3NpdGlvbi5pbmRleE9mKHBvc2l0aW9uKSwxKTtcclxuICAgICAgICB0aGlzLmhpdHMrKztcclxuICAgICAgICB0aGlzLmlzU3Vuayh0aGlzLmhpdHMpO1xyXG4gICAgfVxyXG5cclxuICAgIGlzU3Vuaygpey8vIG9uY2UgYWxsIGhpdCBpdCBzaW5rc1xyXG4gICAgICAgIGlmKHRoaXMucG9zaXRpb24ubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGFzU3Vua2VuID0gdHJ1ZTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59IiwiLyogZXNsaW50LWRpc2FibGUgbm8tcGFyYW0tcmVhc3NpZ24gKi9cclxuaW1wb3J0IFBsYXllciBmcm9tIFwiLi4vbW9kdWxlcy9wbGF5ZXJcIlxyXG5pbXBvcnQgU2hpcHMgZnJvbSBcIi4uL21vZHVsZXMvc2hpcFwiXHJcbmltcG9ydCBnYW1lQm9hcmQgZnJvbSBcIi4vZ2FtZUJvYXJkXCI7XHJcblxyXG5jb25zdCBwbGF5ZXIgPSBuZXcgUGxheWVyKFwicGxheWVyXCIpO1xyXG5jb25zdCBjb21wdXRlciA9IG5ldyBQbGF5ZXIoXCJjb21wdXRlclwiKVxyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBzaGlwcygpe1xyXG4gICAgZ2FtZUJvYXJkKCk7XHJcblxyXG4gICAgY29uc3QgZ2V0UmFuZG9tTGVnYWxQb3NpdGlvbiA9IChqLCBwZXJzb24pPT57XHJcbiAgICAgICAgY29uc3QgcmFuZG9tTnVtYmVyID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTtcclxuICAgICAgICBjb25zdCBuZXdBcnJheSA9IFtdO1xyXG4gICAgICAgIGZvcihsZXQgaSA9IDA7aSA8IGo7aSsrKXtcclxuICAgICAgICAgICAgbmV3QXJyYXkucHVzaChyYW5kb21OdW1iZXIraSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHBlcnNvbi5ib2FyZC5zaGlwc1BsYWNlbWVudChuZXdBcnJheSkpIHJldHVybiBuZXdBcnJheTtcclxuICAgICAgICByZXR1cm4gZ2V0UmFuZG9tTGVnYWxQb3NpdGlvbihqLCBwZXJzb24pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHBsYXllclNoaXBzID0gKCk9PntcclxuICAgICAgICBsZXQgaiA9IDU7XHJcbiAgICAgICAgZm9yKGxldCBpID0gMDtpIDwgNTtpKyspe1xyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhnZXRSYW5kb21MZWdhbFBvc2l0aW9uKGopKTtcclxuICAgICAgICAgICAgY29uc3QgcGxheWVyU2hpcCA9IG5ldyBTaGlwcyhgc2hpcCR7aX1gLGosIGdldFJhbmRvbUxlZ2FsUG9zaXRpb24oaiwgcGxheWVyKSlcclxuICAgICAgICAgICAgcGxheWVyLnNoaXBzLnB1c2gocGxheWVyU2hpcClcclxuICAgICAgICAgICAgaWYoaiA9PT0gMikgY29udGludWU7XHJcbiAgICAgICAgICAgIGotLTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvcihsZXQgaSA9MCA7IGk8NTtpKyspe1xyXG4gICAgICAgICAgICBpZihpPT09MCkgcGxheWVyLmJvYXJkLmhhc1NoaXBBcnJheSA9IFtdO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhwbGF5ZXIuYm9hcmQuc2hpcHNQbGFjZW1lbnQocGxheWVyLnNoaXBzW2ldLnBvc2l0aW9uKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBncmlkSXRlbVBsYXllciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucGxheWVyLTEgLmdyaWQtaXRlbVwiKTtcclxuICAgICAgICBncmlkSXRlbVBsYXllci5mb3JFYWNoKChncmlkKT0+e1xyXG4gICAgICAgIGlmKHBsYXllci5ib2FyZC5oYXNTaGlwQXJyYXkuaW5jbHVkZXMocGFyc2VJbnQoZ3JpZC5pZCwgMTApKSl7XHJcbiAgICAgICAgICAgIGdyaWQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJncmVlblwiO1xyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY29tcHV0ZXJTaGlwcyA9ICgpPT57XHJcbiAgICAgICAgbGV0IGogPSA1O1xyXG4gICAgICAgIGZvcihsZXQgaSA9IDA7aSA8IDU7aSsrKXtcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZ2V0UmFuZG9tTGVnYWxQb3NpdGlvbihqKSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbXBTaGlwID0gbmV3IFNoaXBzKGBzaGlwJHtpfWAsaiwgZ2V0UmFuZG9tTGVnYWxQb3NpdGlvbihqLCBjb21wdXRlcikpXHJcbiAgICAgICAgICAgIGNvbXB1dGVyLnNoaXBzLnB1c2goY29tcFNoaXApXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwib2tcIilcclxuICAgICAgICAgICAgaWYoaiA9PT0gMikgY29udGludWU7XHJcbiAgICAgICAgICAgIGotLTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvcihsZXQgaSA9MCA7IGk8NTtpKyspe1xyXG4gICAgICAgICAgICBpZihpPT09MCkgY29tcHV0ZXIuYm9hcmQuaGFzU2hpcEFycmF5ID0gW107XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGNvbXB1dGVyLmJvYXJkLnNoaXBzUGxhY2VtZW50KGNvbXB1dGVyLnNoaXBzW2ldLnBvc2l0aW9uKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBncmlkSXRlbUNvbXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBsYXllci0yIC5ncmlkLWl0ZW1cIik7XHJcbiAgICAgICAgZ3JpZEl0ZW1Db21wLmZvckVhY2goKGdyaWQpPT57XHJcbiAgICAgICAgaWYoY29tcHV0ZXIuYm9hcmQuaGFzU2hpcEFycmF5LmluY2x1ZGVzKHBhcnNlSW50KGdyaWQuaWQsIDEwKSkpe1xyXG4gICAgICAgICAgICBncmlkLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiZ3JlZW5cIjtcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIHBsYXllclNoaXBzKCk7XHJcbiAgICBjb21wdXRlclNoaXBzKCk7XHJcblxyXG4gICAgY29uc29sZS5sb2coY29tcHV0ZXIpXHJcbn1cclxuXHJcbmV4cG9ydCB7cGxheWVyLCBjb21wdXRlcn0iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnYW1lQm9hcmQoKXtcclxuICAgIGZ1bmN0aW9uIG1ha2VSb3dzKGRpdixyb3dzID0gMTAsIGNvbHM9MTApIHtcclxuICAgICAgICBkaXYuc3R5bGUuc2V0UHJvcGVydHkoXCItLWdyaWQtcm93c1wiLCByb3dzKTtcclxuICAgICAgICBkaXYuc3R5bGUuc2V0UHJvcGVydHkoXCItLWdyaWQtY29sc1wiLCBjb2xzKTtcclxuICAgICAgICBmb3IgKGxldCBjID0gMDsgYyA8IChyb3dzICogY29scyk7IGMrKykge1xyXG4gICAgICAgICAgY29uc3QgY2VsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgICBkaXYuYXBwZW5kQ2hpbGQoY2VsbCk7XHJcbiAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoXCJncmlkLWl0ZW1cIik7XHJcbiAgICAgICAgICBjZWxsLmlkID0gYztcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgY29uc3QgcGxheWVyT25lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGF5ZXItMVwiKTtcclxuICAgIGNvbnN0IHBsYXllclR3byA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxheWVyLTJcIik7XHJcbiAgICBcclxuICAgIG1ha2VSb3dzKHBsYXllck9uZSk7XHJcbiAgICBtYWtlUm93cyhwbGF5ZXJUd28pO1xyXG59IiwiaW1wb3J0IGhpdEJvYXJkIGZyb20gXCIuL2dhbWVDcmVhdGlvbi9oaXRHYW1lQm9hcmRcIjtcclxuaW1wb3J0IHNoaXBzICBmcm9tIFwiLi9nYW1lQ3JlYXRpb24vc2hpcFBsYWNlbWVudFwiO1xyXG5cclxuc2hpcHMoKVxyXG5oaXRCb2FyZCgpOyIsImltcG9ydCB7IGNvbXB1dGVyLCBwbGF5ZXIgfSBmcm9tIFwiLi9zaGlwUGxhY2VtZW50XCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBoaXRCb2FyZCgpe1xyXG5cclxuICAgIGNvbnN0IGNoZWNrR2FtZUVuZCA9IChwZXJzb24pPT57XHJcbiAgICAgICAgaWYocGVyc29uLmJvYXJkLmhhc1NoaXBBcnJheS5sZW5ndGggPT09IDApe1xyXG4gICAgICAgICAgICBjb25zdCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYW1lXCIpO1xyXG4gICAgICAgICAgICBtYWluLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcIm5vbmVcIlxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICBjb25zdCBzaG90c0FycmF5ID0gW11cclxuICAgIGNvbnN0IGdyaWRJdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wbGF5ZXItMSAuZ3JpZC1pdGVtXCIpO1xyXG4gICAgZ3JpZEl0ZW0uZm9yRWFjaCgoaXRlbSk9PntcclxuICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKT0+e1xyXG4gICAgICAgICAgICBjb25zdCBwb3MgPSBwYXJzZUZsb2F0KGl0ZW0uaWQpXHJcbiAgICAgICAgICAgIGlmKCEoc2hvdHNBcnJheS5pbmNsdWRlcyhwb3MpKSl7XHJcbiAgICAgICAgICAgICAgICBzaG90c0FycmF5LnB1c2gocG9zKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKChpdGVtLmlkKSlcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHBsYXllci5ib2FyZClcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNoaXBBcnJheSA9IHBsYXllci5ib2FyZC5oYXNTaGlwQXJyYXlcclxuICAgICAgICAgICAgICAgIGlmKHNoaXBBcnJheS5pbmNsdWRlcyhwb3MpKXtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwicmVkXCJcclxuICAgICAgICAgICAgICAgICAgICBzaGlwQXJyYXkuc3BsaWNlKHNoaXBBcnJheS5pbmRleE9mKHBvcyksMSlcclxuICAgICAgICAgICAgICAgICAgICBjaGVja0dhbWVFbmQocGxheWVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcInllbGxvd1wiXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSlcclxuXHJcbiAgICBjb25zdCBzaG90c0FycmF5Q29tcCA9IFtdXHJcbiAgICBjb25zdCBncmlkSXRlbUNvbXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBsYXllci0yIC5ncmlkLWl0ZW1cIik7XHJcbiAgICBncmlkSXRlbUNvbXAuZm9yRWFjaCgoaXRlbSk9PntcclxuICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKT0+e1xyXG4gICAgICAgICAgICBjb25zdCBwb3MgPSBwYXJzZUZsb2F0KGl0ZW0uaWQpXHJcbiAgICAgICAgICAgIGlmKCEoc2hvdHNBcnJheUNvbXAuaW5jbHVkZXMocG9zKSkpe1xyXG4gICAgICAgICAgICAgICAgc2hvdHNBcnJheUNvbXAucHVzaChwb3MpO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coKGl0ZW0uaWQpKVxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocGxheWVyLmJvYXJkKVxyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2hpcEFycmF5ID0gY29tcHV0ZXIuYm9hcmQuaGFzU2hpcEFycmF5XHJcbiAgICAgICAgICAgICAgICBpZihzaGlwQXJyYXkuaW5jbHVkZXMocG9zKSl7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcInJlZFwiXHJcbiAgICAgICAgICAgICAgICAgICAgc2hpcEFycmF5LnNwbGljZShzaGlwQXJyYXkuaW5kZXhPZihwb3MpLDEpXHJcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tHYW1lRW5kKGNvbXB1dGVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcInllbGxvd1wiXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSApXHJcbn0iXSwibmFtZXMiOlsiY29uc3RydWN0b3IiLCJuYW1lIiwidGhpcyIsInNoaXBzIiwiYm9hcmQiLCJib2FyZFBvc2l0aW9uQXJyYXkiLCJoYXNTaGlwQXJyYXkiLCJib2FyZENyZWF0ZSIsImkiLCJwdXNoIiwicmVjZWl2ZUF0dGFjayIsInBvcyIsImluY2x1ZGVzIiwic3BsaWNlIiwiY2hlY2tpbmdJZkhpdCIsImluZGV4T2YiLCJnYW1lRW5kIiwibGVuZ3RoIiwic2hpcHNQbGFjZW1lbnQiLCJzaGlwc0FyciIsInNob3J0ZWRTaGlwc0FyciIsInNvcnQiLCJhIiwiYiIsImJvcmRlckhvcml6b250YWwiLCJib3JkZXJWZXJ0aWNhbCIsImV2ZXJ5IiwiZWxlbSIsIlNoaXBzIiwicG9zaXRpb24iLCJoaXRzIiwiaGFzU3Vua2VuIiwiaGl0IiwiaXNTdW5rIiwiY29tcHV0ZXIiLCJtYWtlUm93cyIsImRpdiIsInJvd3MiLCJjb2xzIiwic3R5bGUiLCJzZXRQcm9wZXJ0eSIsImMiLCJjZWxsIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiYXBwZW5kQ2hpbGQiLCJjbGFzc0xpc3QiLCJhZGQiLCJpZCIsInBsYXllck9uZSIsInF1ZXJ5U2VsZWN0b3IiLCJwbGF5ZXJUd28iLCJnZXRSYW5kb21MZWdhbFBvc2l0aW9uIiwiaiIsInBlcnNvbiIsInJhbmRvbU51bWJlciIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsIm5ld0FycmF5IiwicGxheWVyU2hpcCIsImNvbnNvbGUiLCJsb2ciLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImdyaWQiLCJwYXJzZUludCIsImJhY2tncm91bmRDb2xvciIsInBsYXllclNoaXBzIiwiY29tcFNoaXAiLCJjb21wdXRlclNoaXBzIiwiY2hlY2tHYW1lRW5kIiwicG9pbnRlckV2ZW50cyIsInNob3RzQXJyYXkiLCJpdGVtIiwiYWRkRXZlbnRMaXN0ZW5lciIsInBhcnNlRmxvYXQiLCJzaGlwQXJyYXkiLCJzaG90c0FycmF5Q29tcCIsImhpdEJvYXJkIl0sInNvdXJjZVJvb3QiOiIifQ==